<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elegance - Editorial CMS</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@200..800&family=Frank+Ruhl+Libre:wght@300..900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-linen: #f2ece0;
            --text-main: #2c2c2c;
            --dynamic-accent: #2c3e50; /* Indigo Slate Default */
            --accent-ochre: #d4a017;
            --moss-green: #3e4e3e;
        }
        
        body {
            font-family: 'Assistant', sans-serif;
            background-color: var(--bg-linen);
            color: var(--text-main);
            background-image: 
                linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px);
            background-size: 20px 20px;
            transition: background-color 0.5s ease;
        }
        
        .serif {
            font-family: 'Frank Ruhl Libre', serif;
        }
        
        /* Main Title Animation */
        .brand-title {
            color: var(--dynamic-accent);
            text-shadow: 2px 2px 0px rgba(212, 160, 23, 0.1);
            transition: color 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Post Styling */
        .prose h2 { 
            font-family: 'Frank Ruhl Libre', serif; 
            font-size: 2.5rem; 
            font-weight: 600; 
            margin-top: 3rem; 
            margin-bottom: 1.5rem; 
            color: var(--dynamic-accent);
            border-bottom: 2px solid var(--accent-ochre);
            display: inline-block;
            transition: color 0.8s ease;
        }
        
        .prose p { line-height: 2; margin-bottom: 2rem; font-size: 1.3rem; color: #333; }
        
        /* Drop Cap */
        .prose p:first-of-type::first-letter {
            float: right;
            font-family: 'Frank Ruhl Libre', serif;
            font-size: 5rem;
            line-height: 1;
            padding: 0.5rem 0 0.5rem 1rem;
            color: var(--dynamic-accent);
            font-weight: 700;
            transition: color 0.8s ease;
        }

        .prose blockquote {
            border-right: 6px solid var(--dynamic-accent);
            padding: 1.5rem 2.5rem;
            margin: 3.5rem 0;
            font-style: italic;
            color: var(--dynamic-accent);
            font-size: 1.75rem;
            background: rgba(0, 0, 0, 0.02);
            font-family: 'Frank Ruhl Libre', serif;
            transition: all 0.8s ease;
        }

        /* UI Elements */
        #debug-status {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #1e272e;
            color: #e0e0e0;
            font-family: monospace;
            font-size: 11px;
            padding: 6px 15px;
            z-index: 100;
            border-bottom: 2px solid var(--dynamic-accent);
            display: flex;
            justify-content: space-between;
            direction: ltr;
        }
        
        .publish-btn {
            background: var(--dynamic-accent);
            color: #fff;
            transition: all 0.4s;
        }
        
        #reading-progress {
            position: fixed;
            top: 0;
            right: 0;
            height: 4px;
            background: var(--dynamic-accent);
            z-index: 110;
            width: 0%;
            transition: background-color 0.8s ease;
        }

        .nav-link {
            position: relative;
            transition: color 0.3s;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -4px;
            right: 0;
            width: 0%;
            height: 2px;
            background: var(--dynamic-accent);
            transition: width 0.3s, background-color 0.8s;
        }
        .nav-link:hover::after, .nav-link.active::after {
            width: 100%;
        }

        .color-dot {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            border: 1px solid rgba(0,0,0,0.1);
        }
        .color-dot:hover {
            transform: scale(1.3);
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .color-dot.active {
            border: 2px solid white;
            box-shadow: 0 0 0 2px var(--text-main);
        }

        .view-section { display: none; }
        .view-section.active { display: block; }

        ::selection { background: var(--dynamic-accent); color: white; }
    </style>
    
    <script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@1.34.0",
    "react": "https://esm.sh/react@^19.2.3",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
</head>
<body class="antialiased">
    <div id="reading-progress"></div>

    <div id="debug-status">
        <span><b>SYSTEM:</b> Custom Palettes Active âœ… | Sync: <span id="last-update-time">--:--</span></span>
        <span>Live Colors (ğŸ¨)</span>
    </div>

    <div class="min-h-screen flex flex-col max-w-5xl mx-auto px-6 py-24">
        <header class="flex flex-col items-center text-center mb-28">
            <!-- Palette Selector -->
            <div class="flex gap-3 mb-12 p-2 bg-white/40 rounded-full border border-white/60 shadow-sm">
                <div onclick="setAccent('#2c3e50', this)" class="color-dot active" style="background: #2c3e50;" title="Slate"></div>
                <div onclick="setAccent('#1b3022', this)" class="color-dot" style="background: #1b3022;" title="Forest"></div>
                <div onclick="setAccent('#6d214f', this)" class="color-dot" style="background: #6d214f;" title="Mulberry"></div>
                <div onclick="setAccent('#227093', this)" class="color-dot" style="background: #227093;" title="Deep Sea"></div>
                <div onclick="setAccent('#3e4e3e', this)" class="color-dot" style="background: #3e4e3e;" title="Moss"></div>
                <div onclick="setAccent('#d35400', this)" class="color-dot" style="background: #d35400;" title="Burnt Orange"></div>
                <div onclick="setAccent('#4b4b4b', this)" class="color-dot" style="background: #4b4b4b;" title="Espresso"></div>
                <div onclick="setAccent('#586730', this)" class="color-dot" style="background: #586730;" title="Olive"></div>
                <div onclick="setAccent('#30336b', this)" class="color-dot" style="background: #30336b;" title="Indigo"></div>
                <div onclick="setAccent('#9b6b6b', this)" class="color-dot" style="background: #9b6b6b;" title="Dusty Rose"></div>
            </div>

            <h1 onclick="navigateTo('list')" class="serif brand-title text-8xl md:text-[10rem] font-bold tracking-tighter cursor-pointer">
                Elegance.
            </h1>
            <div class="h-1 w-32 bg-[var(--accent-ochre)] mt-12 mb-6"></div>
            <p class="text-zinc-600 text-sm uppercase tracking-[0.4em] font-black">Curated Thoughts â€¢ Live Palettes â€¢ Modern Life</p>
            
            <nav class="flex gap-16 mt-20 text-[11px] font-black uppercase tracking-[0.25em] text-zinc-400">
                <button onclick="navigateTo('list')" id="nav-list" class="nav-link hover:text-[var(--text-main)]">×”××¨×›×™×•×Ÿ</button>
                <button onclick="openEditor()" id="nav-compose" class="nav-link hover:text-[var(--text-main)]">×›×ª×•×‘ ××©×”×•</button>
                <button onclick="toggleSettings()" class="nav-link hover:text-[var(--text-main)]">×¡× ×›×¨×•×Ÿ</button>
            </nav>

            <div id="publish-container" class="mt-12 hidden">
                <button onclick="publishToGithub()" id="global-publish-btn" class="publish-btn px-10 py-4 rounded-full text-xs font-black uppercase tracking-[0.2em]">
                    ×¤×¨×¡× ×©×™× ×•×™×™× ×œ×¢× ×Ÿ
                </button>
            </div>
        </header>

        <main id="main-content" class="flex-grow">
            <!-- List View -->
            <section id="view-list" class="view-section active">
                <div id="posts-container" class="grid grid-cols-1 gap-12"></div>
            </section>

            <!-- Detail View -->
            <section id="view-detail" class="view-section">
                <div class="flex justify-between items-center mb-20 border-b-2 border-zinc-200 pb-8">
                    <button onclick="navigateTo('list')" class="text-xs font-black uppercase tracking-widest text-zinc-400 hover:text-black">â† ×—×–×¨×”</button>
                    <div class="flex gap-8">
                        <button id="edit-post-btn" class="text-xs font-black uppercase tracking-widest text-zinc-400 hover:text-[var(--dynamic-accent)]">×¢×¨×•×š</button>
                        <button id="delete-post-btn" class="text-xs font-black uppercase tracking-widest text-red-300 hover:text-red-700">××—×§</button>
                    </div>
                </div>
                <article id="post-detail-content" class="max-w-3xl mx-auto"></article>
            </section>

            <!-- Editor View -->
            <section id="view-editor" class="view-section">
                <div class="max-w-3xl mx-auto">
                    <div class="bg-white/50 p-10 rounded-3xl mb-16 border-2 border-dashed border-zinc-300">
                        <h3 class="serif text-2xl font-bold mb-6 text-[var(--dynamic-accent)]">×¢×•×–×¨ ×™×¦×™×¨×ª×™ AI</h3>
                        <div class="flex gap-4">
                            <input type="text" id="ai-prompt" placeholder="× ×•×©× ×œ××××¨ ×”×‘× ×©×œ×š..." class="flex-grow bg-white border-2 border-zinc-200 rounded-2xl px-6 py-4 text-sm focus:border-[var(--dynamic-accent)] outline-none transition-all">
                            <button onclick="generateWithAI()" id="ai-btn" class="bg-[var(--dynamic-accent)] text-white px-8 py-4 rounded-2xl text-xs font-black uppercase hover:opacity-80 transition-all">×¦×•×¨</button>
                        </div>
                    </div>
                    <div class="space-y-12">
                        <input type="text" id="edit-title" placeholder="×›×•×ª×¨×ª ×¢×•×¦××ª×™×ª" class="w-full serif text-6xl font-bold bg-transparent border-none focus:ring-0 placeholder-zinc-300 text-[var(--dynamic-accent)]">
                        <input type="text" id="edit-category" placeholder="×§×˜×’×•×¨×™×”" class="w-full text-sm font-black uppercase tracking-widest border-b-2 border-zinc-200 bg-transparent focus:border-[var(--accent-ochre)] outline-none py-4 text-[var(--accent-ochre)]">
                        <textarea id="edit-excerpt" placeholder="×ª×§×¦×™×¨ ××•×©×š..." rows="3" class="w-full text-2xl text-zinc-500 bg-transparent border-none focus:ring-0 resize-none italic font-light"></textarea>
                        <textarea id="edit-content" placeholder="×”×¡×™×¤×•×¨ ×©×œ×š ××ª×—×™×œ ×›××Ÿ..." rows="15" class="w-full text-xl leading-relaxed bg-white/40 border-2 border-zinc-100 rounded-3xl p-8 focus:bg-white focus:ring-0 transition-all"></textarea>
                        
                        <div class="pt-10 flex gap-6">
                            <button onclick="saveChanges()" class="bg-[var(--dynamic-accent)] text-white px-16 py-6 rounded-full text-xs font-black uppercase tracking-[0.2em] hover:scale-105 transition-all shadow-xl">×©××•×¨ ××××¨</button>
                            <button onclick="navigateTo('list')" class="px-12 py-6 rounded-full text-xs font-black uppercase tracking-[0.2em] text-zinc-400 hover:text-black">×‘×™×˜×•×œ</button>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Settings -->
        <div id="settings-modal" class="fixed inset-0 bg-[var(--bg-linen)]/95 z-[200] hidden flex items-center justify-center p-8 backdrop-blur-md">
            <div class="max-w-md w-full space-y-12 bg-white p-12 rounded-[3rem] shadow-2xl">
                <div class="text-center">
                    <h2 class="serif text-4xl font-bold text-[var(--dynamic-accent)]">×”×’×“×¨×•×ª ×¡× ×›×¨×•×Ÿ</h2>
                </div>
                <div class="space-y-6">
                    <div class="space-y-2">
                        <label class="text-[10px] font-black uppercase tracking-widest text-zinc-400">Personal Token</label>
                        <input type="password" id="gh-token" class="w-full border-2 border-zinc-100 rounded-2xl p-4 text-sm focus:border-[var(--accent-ochre)] outline-none">
                    </div>
                    <div class="grid grid-cols-2 gap-6">
                        <div class="space-y-2">
                            <label class="text-[10px] font-black uppercase tracking-widest text-zinc-400">Username</label>
                            <input type="text" id="gh-owner" class="w-full border-2 border-zinc-100 rounded-2xl p-4 text-sm outline-none">
                        </div>
                        <div class="space-y-2">
                            <label class="text-[10px] font-black uppercase tracking-widest text-zinc-400">Repo Name</label>
                            <input type="text" id="gh-repo" class="w-full border-2 border-zinc-100 rounded-2xl p-4 text-sm outline-none">
                        </div>
                    </div>
                </div>
                <div class="flex gap-4">
                    <button onclick="saveSettings()" class="flex-grow bg-[var(--dynamic-accent)] text-white py-5 rounded-2xl text-xs font-black uppercase tracking-widest hover:opacity-80">×©××•×¨</button>
                    <button onclick="toggleSettings()" class="flex-grow bg-zinc-100 py-5 rounded-2xl text-xs font-black uppercase tracking-widest">×¡×’×•×¨</button>
                </div>
            </div>
        </div>

        <footer class="mt-48 pt-20 border-t-2 border-zinc-200 pb-24 text-zinc-400 text-[11px] font-black uppercase tracking-[0.4em] flex flex-col md:flex-row justify-between items-center">
            <p>&copy; 2024 Elegance Editorial CMS. Created for the bold.</p>
            <div class="flex gap-12 mt-8 md:mt-0">
                <a href="#" class="hover:text-[var(--dynamic-accent)] transition-colors">Archive</a>
                <a href="#" class="hover:text-[var(--dynamic-accent)] transition-colors">Instagram</a>
                <a href="#" class="hover:text-[var(--dynamic-accent)] transition-colors">Colophon</a>
            </div>
        </footer>
    </div>

    <script type="module">
        import { GoogleGenAI, Type } from "@google/genai";

        // --- PALETTE LOGIC ---
        window.setAccent = (color, el) => {
            document.documentElement.style.setProperty('--dynamic-accent', color);
            document.querySelectorAll('.color-dot').forEach(d => d.classList.remove('active'));
            el.classList.add('active');
            localStorage.setItem('blog_accent', color);
        };

        // Initialize saved color
        const savedColor = localStorage.getItem('blog_accent');
        if (savedColor) {
            document.documentElement.style.setProperty('--dynamic-accent', savedColor);
            setTimeout(() => {
                const dots = document.querySelectorAll('.color-dot');
                dots.forEach(d => {
                    if (d.style.backgroundColor === savedColor || d.getAttribute('style').includes(savedColor)) {
                        d.classList.add('active');
                    } else {
                        d.classList.remove('active');
                    }
                });
            }, 100);
        }

        // --- DATA ---
        let posts = [
            {
                id: '1',
                title: '×”×—×™×™× ×‘×§×¦×‘×™×•×ª ×©×œ ×—×•× ×•×¦×‘×¢',
                excerpt: '×›×™×¦×“ ×©×™××•×© × ×›×•×Ÿ ×‘×¤×œ×˜×ª ×¦×‘×¢×™× ×—××” ××©×¤×™×¢ ×¢×œ ××¦×‘ ×”×¨×•×— ×•×”×¤×¨×•×“×•×§×˜×™×‘×™×•×ª ×©×œ× ×• ×‘××¨×—×‘ ×”××’×•×¨×™×.',
                content: '<h2>×”×›×•×— ×©×œ ×”×¦×‘×¢ ×‘××¨×—×‘</h2><p>×¦×‘×¢ ××™× ×• ×¨×§ ×¢× ×™×™×Ÿ ×©×œ ××¡×ª×˜×™×§×”. ×”×•× ×©×¤×” ×©×¤×•×¢×œ×ª ×¢×œ ×”×ª×ª-××•×“×¢ ×©×œ× ×•. ×›×©×× ×—× ×• ×‘×•×—×¨×™× ×‘×’×•×•× ×™ ××“××”, ×× ×—× ×• ××—×‘×¨×™× ××ª ×”×‘×™×ª ×©×œ× ×• ×œ×©×•×¨×©×™× ×¢×ª×™×§×™×. ×–×”×• ×¦×‘×¢ ×©××©×“×¨ ×‘×™×˜×—×•×Ÿ, ×™×¦×™×‘×•×ª ×•×—×•× ×× ×•×©×™.</p><blockquote>×”×¦×‘×¢ ×”×•× ×”××§×•× ×©×‘×• ×”××•×— ×©×œ× ×• ×•×”×™×§×•× × ×¤×’×©×™×.</blockquote><p>×‘××—×§×¨×™× ×¢×œ ×¢×™×¦×•×‘ ×¤× ×™× × ××¦× ×›×™ ××¨×—×‘×™× ×”××©×œ×‘×™× ×’×•×•× ×™× ×˜×‘×¢×™×™× ××¢×•×“×“×™× ×©×™×—×” ×¤×ª×•×—×” ×™×•×ª×¨ ×•×¨×™×›×•×– ××•×’×‘×¨. ×–×”×• ×œ× ×˜×¨× ×“ ×—×•×œ×£, ××œ× ×—×–×¨×” ×œ××œ×× ×˜×™× ×‘×¡×™×¡×™×™×.</p>',
                date: '20 ×™×•× ×™ 2024',
                category: '×œ×™×™×£ ×¡×˜×™×™×œ'
            },
            {
                id: '2',
                title: '××¨×›×™×˜×§×˜×•×¨×” ×©×œ ××™×œ×™×',
                excerpt: '×›×ª×™×‘×” ×”×™× ×›××• ×‘× ×™×™×”: ×¢×œ×™× ×• ×œ×”×‘×˜×™×— ×©×”×™×¡×•×“×•×ª ×—×–×§×™× ××¡×¤×™×§ ×œ×¤× ×™ ×©×× ×—× ×• ××¢×˜×¨×™× ××ª ×”×’×’.',
                content: '<h2>×œ×‘× ×•×ª ××©×¤×˜, ×œ×‘× ×•×ª ×‘×™×ª</h2><p>×¡×•×¤×¨ ×˜×•×‘ ×”×•× ×‘×¨××© ×•×‘×¨××©×•× ×” ××“×¨×™×›×œ. ×”××‘× ×” ×©×œ ×”×¤×¡×§×” ×”×•× ×”×©×œ×“ ×©××—×–×™×§ ××ª ×”×¨×¢×™×•×Ÿ. ×œ×œ× ××‘× ×” ×œ×•×’×™ ×‘×¨×•×¨, ×”××™×œ×™× ×”×™×¤×•×ª ×‘×™×•×ª×¨ ×™×§×¨×¡×• ×ª×—×ª ××©×§×œ×Ÿ.</p><p>×‘×¢×•×œ× ×”×“×™×’×™×˜×œ×™, ×”××‘× ×” ×”×•×¤×š ×œ×—×©×•×‘ ×¢×•×“ ×™×•×ª×¨. ×”×§×•×¨× ×”××•×“×¨× ×™ ×¡×•×¨×§ ××ª ×”×˜×§×¡×˜, ×•××—×¤×© ×¢×•×’× ×™× ×•×™×–×•××œ×™×™× ×•×¨×¢×™×•× ×™×™×.</p>',
                date: '18 ×™×•× ×™ 2024',
                category: '×›×ª×™×‘×”'
            },
            {
                id: '3',
                title: '×”×¢×™×¨ ×›×§× ×‘×¡ ××™× ×¡×•×¤×™',
                excerpt: '××’×¨×¤×™×˜×™ ×•×¢×“ ×ª×›× ×•×Ÿ ×¢×™×¨×•× ×™ - ×›×™×¦×“ ×”××¨×—×‘ ×”×¦×™×‘×•×¨×™ ×”×•×¤×š ×œ×™×¦×™×¨×ª ××× ×•×ª ××©×•×ª×¤×ª ×œ×›×•×œ× ×•.',
                content: '<h2>×œ×œ×›×ª ×œ××™×‘×•×“ ×‘×›×•×•× ×”</h2><p>×”×¢×™×¨ ×”×’×“×•×œ×” ×”×™× ×œ× ×¨×§ ××§×•× ××’×•×¨×™×, ×”×™× ×’×•×£ ×—×™ ×•× ×•×©×. ×›×œ ×¤×™× ×ª ×¨×—×•×‘ ××¡×¤×¨×ª ×¡×™×¤×•×¨ ××—×¨. ××™ ×©××©×›×™×œ ×œ×”×ª×‘×•× ×Ÿ ×‘×¤×¨×˜×™× ×”×§×˜× ×™× - ×‘×˜×§×¡×˜×•×¨×” ×©×œ ×”×‘×˜×•×Ÿ, ×‘×¦×‘×¢ ×”××ª×§×œ×£ ×©×œ ×”×“×œ×ª×•×ª - ××’×œ×” ×¢×•×œ× ×•××œ×•××•.</p>',
                date: '15 ×™×•× ×™ 2024',
                category: '×ª×¨×‘×•×ª'
            },
            {
                id: '4',
                title: '×¤×©×˜×•×ª ×”×™× ×”×ª×—×›×•× ×”××•×œ×˜×™××˜×™×‘×™',
                excerpt: '×¢×œ ×”×§×¡× ×©×‘×“×™×•×§ ×”××™× ×™××œ×™×¡×˜×™ ×•×¢×œ ×”×™×›×•×œ×ª ×œ×•××¨ ×”×¨×‘×” ×‘×¤×—×•×ª.',
                content: '<h2>×¤×—×•×ª ××‘×œ ×˜×•×‘ ×™×•×ª×¨</h2><p>×”××™××¨×” ×”××¤×•×¨×¡××ª ×©×œ ×“×™×˜×¨ ×¨×××¡ ×¨×œ×•×•× ×˜×™×ª ×”×™×•× ×™×•×ª×¨ ××ª××™×“. ×‘×¢×™×“×Ÿ ×©×œ ×¢×•××¡ ×§×•×’× ×™×˜×™×‘×™, ×”×¤×©×˜×•×ª ×”×™× ××ª× ×”. ×”×™× ×××¤×©×¨×ª ×œ× ×• ×œ×”×ª××§×“ ×‘××” ×©×—×©×•×‘ ×‘×××ª.</p>',
                date: '10 ×™×•× ×™ 2024',
                category: '×¢×™×¦×•×‘'
            }
        ];

        let hasChanges = false;
        let currentEditingId = null;

        // --- Scrolling ---
        window.onscroll = () => {
            let winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            let height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            let scrolled = (winScroll / height) * 100;
            document.getElementById("reading-progress").style.width = scrolled + "%";
        };

        // --- Navigation ---
        window.navigateTo = (view, postId = null) => {
            document.querySelectorAll('.view-section').forEach(s => s.classList.remove('active'));
            document.getElementById(`view-${view}`).classList.add('active');
            
            document.querySelectorAll('nav button').forEach(b => b.classList.remove('active', 'text-[var(--text-main)]'));
            const activeNav = document.getElementById(`nav-${view}`);
            if (activeNav) activeNav.classList.add('active', 'text-[var(--text-main)]');

            if (view === 'list') renderPosts();
            if (view === 'detail') renderDetail(postId);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        };

        // --- Rendering ---
        function renderPosts() {
            const container = document.getElementById('posts-container');
            container.innerHTML = posts.map(post => `
                <article onclick="navigateTo('detail', '${post.id}')" class="group cursor-pointer py-16 first:pt-0 border-b border-zinc-200 last:border-0 hover:bg-white/20 px-4 transition-all duration-500 rounded-3xl">
                    <div class="flex flex-col md:flex-row justify-between items-baseline mb-8 gap-6">
                        <h2 class="serif text-4xl md:text-6xl font-bold group-hover:text-[var(--dynamic-accent)] transition-colors duration-500 leading-tight">${post.title}</h2>
                        <time class="text-zinc-400 text-[10px] font-black uppercase tracking-[0.4em] shrink-0">${post.date}</time>
                    </div>
                    <p class="text-zinc-500 text-2xl leading-relaxed max-w-3xl mb-10 font-light">${post.excerpt}</p>
                    <div class="flex items-center gap-6">
                        <span class="text-[10px] font-black uppercase tracking-[0.3em] text-[var(--accent-ochre)] bg-[var(--accent-ochre)]/10 px-4 py-2 rounded-full">${post.category}</span>
                        <span class="text-[10px] font-black text-zinc-300 uppercase tracking-widest group-hover:text-[var(--text-main)] transition-colors">×’×œ×” ×¢×•×“ â€¢</span>
                    </div>
                </article>
            `).join('');
            updatePublishUI();
        }

        function renderDetail(id) {
            const post = posts.find(p => p.id === id);
            if (!post) return navigateTo('list');
            document.getElementById('post-detail-content').innerHTML = `
                <header class="mb-24 text-center">
                    <div class="text-[11px] font-black uppercase tracking-[0.5em] text-[var(--accent-ochre)] mb-10">${post.category} â€¢ ${post.date}</div>
                    <h1 class="serif text-6xl md:text-8xl font-bold mb-14 leading-[1.05] tracking-tighter text-[var(--dynamic-accent)]">${post.title}</h1>
                    <div class="max-w-2xl mx-auto">
                        <p class="text-3xl text-zinc-500 italic font-light leading-relaxed">${post.excerpt}</p>
                    </div>
                    <div class="h-2 w-24 bg-[var(--dynamic-accent)] mx-auto mt-20 transition-all duration-1000"></div>
                </header>
                <div class="prose max-w-none">${post.content}</div>
                <div class="mt-40 pt-24 border-t-2 border-zinc-200 text-center">
                    <p class="serif text-2xl mb-10 font-bold">×¡×•×£ ×”××××¨.</p>
                    <button onclick="navigateTo('list')" class="text-[11px] font-black uppercase tracking-[0.4em] text-[var(--dynamic-accent)] hover:text-black transition-colors underline underline-offset-8">×—×–×•×¨ ×œ××¨×›×™×•×Ÿ</button>
                </div>
            `;
            document.getElementById('edit-post-btn').onclick = () => openEditor(post.id);
            document.getElementById('delete-post-btn').onclick = () => deletePost(post.id);
        }

        // --- Editor ---
        window.openEditor = (id = null) => {
            currentEditingId = id;
            const post = id ? posts.find(p => p.id === id) : { title: '', category: '×¢×™×¦×•×‘', excerpt: '', content: '' };
            document.getElementById('edit-title').value = post.title;
            document.getElementById('edit-category').value = post.category;
            document.getElementById('edit-excerpt').value = post.excerpt;
            document.getElementById('edit-content').value = post.content;
            navigateTo('editor');
        };

        window.saveChanges = () => {
            const data = {
                title: document.getElementById('edit-title').value,
                category: document.getElementById('edit-category').value,
                excerpt: document.getElementById('edit-excerpt').value,
                content: document.getElementById('edit-content').value,
                date: new Date().toLocaleDateString('he-IL', { day: 'numeric', month: 'long', year: 'numeric' })
            };

            if (currentEditingId) {
                const idx = posts.findIndex(p => p.id === currentEditingId);
                posts[idx] = { ...posts[idx], ...data };
            } else {
                posts.unshift({ id: Date.now().toString(), ...data });
            }

            hasChanges = true;
            navigateTo('list');
        };

        function deletePost(id) {
            if (!confirm("×”×× ×œ××—×•×§ ×œ×¦××™×ª×•×ª?")) return;
            posts = posts.filter(p => p.id !== id);
            hasChanges = true;
            navigateTo('list');
        }

        // --- Sync ---
        window.toggleSettings = () => {
            const modal = document.getElementById('settings-modal');
            modal.classList.toggle('hidden');
            if (!modal.classList.contains('hidden')) {
                document.getElementById('gh-token').value = localStorage.getItem('gh_token') || '';
                document.getElementById('gh-owner').value = localStorage.getItem('gh_owner') || '';
                document.getElementById('gh-repo').value = localStorage.getItem('gh_repo') || '';
            }
        };

        window.saveSettings = () => {
            localStorage.setItem('gh_token', document.getElementById('gh-token').value);
            localStorage.setItem('gh_owner', document.getElementById('gh-owner').value);
            localStorage.setItem('gh_repo', document.getElementById('gh-repo').value);
            toggleSettings();
            updatePublishUI();
        };

        function updatePublishUI() {
            const btn = document.getElementById('global-publish-btn');
            const container = document.getElementById('publish-container');
            const token = localStorage.getItem('gh_token');
            if (hasChanges) {
                container.classList.remove('hidden');
                if (token) {
                    btn.classList.add('dirty');
                    btn.classList.remove('opacity-50', 'cursor-not-allowed');
                    btn.disabled = false;
                }
            } else {
                container.classList.add('hidden');
            }
        }

        window.publishToGithub = async () => {
            const btn = document.getElementById('global-publish-btn');
            const token = localStorage.getItem('gh_token');
            const owner = localStorage.getItem('gh_owner');
            const repo = localStorage.getItem('gh_repo');

            if (!token) return alert("×× × ×”×’×“×¨ ×˜×•×§×Ÿ.");

            btn.disabled = true;
            btn.innerText = "××¢×œ×”...";

            try {
                const apiUrl = `https://api.github.com/repos/${owner}/${repo}/contents/index.html`;
                const res = await fetch(apiUrl, { headers: { 'Authorization': `token ${token}` }});
                const fileData = await res.json();
                const currentContent = decodeURIComponent(escape(atob(fileData.content)));

                const newPostsJson = JSON.stringify(posts, null, 12);
                const newContent = currentContent.replace(/let posts = \[[\s\S]*?\];/, `let posts = ${newPostsJson};`);

                const updateRes = await fetch(apiUrl, {
                    method: 'PUT',
                    headers: { 'Authorization': `token ${token}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message: "Content Update",
                        content: btoa(unescape(encodeURIComponent(newContent))),
                        sha: fileData.sha
                    })
                });

                if (updateRes.ok) {
                    alert("×”×¤×¨×¡×•× ×”×•×©×œ×!");
                    hasChanges = false;
                    document.getElementById('last-update-time').innerText = new Date().toLocaleTimeString();
                    updatePublishUI();
                }
            } catch (err) { alert("×©×’×™××”!"); } finally { 
                btn.disabled = false; 
                btn.innerText = "×¤×¨×¡× ×©×™× ×•×™×™× ×œ×¢× ×Ÿ";
            }
        };

        // --- AI ---
        window.generateWithAI = async () => {
            const prompt = document.getElementById('ai-prompt').value;
            const btn = document.getElementById('ai-btn');
            if (!prompt) return;

            btn.disabled = true;
            btn.innerText = '×× ×¡×—...';

            try {
                const ai = new GoogleGenAI({ apiKey: window.process.env.API_KEY });
                const response = await ai.models.generateContent({
                    model: 'gemini-3-flash-preview',
                    contents: `×¦×•×¨ ××××¨ ××¨×ª×§ ×‘×¢×‘×¨×™×ª ×’×‘×•×”×” ×¢×œ: ${prompt}. ×”×—×–×¨ JSON: title, content (HTML), excerpt.`,
                    config: {
                        responseMimeType: 'application/json',
                        responseSchema: {
                            type: Type.OBJECT,
                            properties: {
                                title: { type: Type.STRING },
                                content: { type: Type.STRING },
                                excerpt: { type: Type.STRING }
                            },
                            required: ['title', 'content', 'excerpt']
                        }
                    }
                });
                const data = JSON.parse(response.text);
                document.getElementById('edit-title').value = data.title;
                document.getElementById('edit-excerpt').value = data.excerpt;
                document.getElementById('edit-content').value = data.content;
            } catch (e) { alert("AI Error"); } finally { btn.disabled = false; btn.innerText = '×¦×•×¨'; }
        };

        // --- Init ---
        document.getElementById('last-update-time').innerText = new Date().toLocaleTimeString();
        renderPosts();
    </script>
</body>
</html>